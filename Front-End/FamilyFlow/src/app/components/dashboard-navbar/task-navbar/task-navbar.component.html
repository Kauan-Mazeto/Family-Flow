<div class="choice">
    <h3 
        [class.active]="isTabActive.diarias"
        (click)="onTabClick('diarias')"
    >
        Tarefas Diárias
    </h3>
    <h3 
        [class.active]="isTabActive.pontuais"
        (click)="onTabClick('pontuais')"
    >
        Tarefas Pontuais
    </h3>
    <h3
        [class.active]="isTabActive.grafico"
        (click)="onTabClick('grafico')"
    >
        Gráfico de Tarefas
    </h3>
</div>

<!--Conteúdo de Tarefas Diárias-->
<div class="task" *ngIf="isTabActive.diarias">
    <div class="task-desc">
        <div class="desc">
            <div class="desc-text">
                <h1>Tarefas Diárias</h1>
                <p>Tarefas criadas apenas pelo Administrador</p>
            </div>

            <button class="create-task" (click)="openCreateTaskModal()">
                <i class="fas fa-plus"></i> 
                Criar Tarefa Diária
            </button>
        </div>
    </div>

    <div class="tasks">
        <div class="task-card">
            <div class="task-info">
                <div class="responsible">
                    <input type="checkbox" class="check-response">
                    <span class="fas fa-trash"></span>
                </div>
                <h2>Limpar a cozinha</h2>
                <p>Lorem ipsum dolor sit, amet consectetur adipisicing elit. Ullam fugiat doloremque rerum architecto. Corporis praesentium veritatis, sapiente ipsam, sint voluptates in incidunt tempore ducimus error, facilis atque tenetur? Similique, quidem!</p>
                
            </div>

            <div class="task-atribute">
                <span class="task-priority">Prioridade alta</span>
                <span class="task-status">Pendente</span>
                <span class="task-responsible">João Silva</span>
            </div>
        </div>
    </div>
</div>



<!--Conteúdo de Tarefas Pontuais-->
<div class="task" *ngIf="isTabActive.pontuais">
    <div class="task-desc">
        <div class="desc">
            <div class="desc-text">
                <h1>Tarefas Pontuais</h1>
                <p>Tarefas criadas e visualizadas por você</p>
            </div>

            <button class="create-task">
                <i class="fas fa-plus"></i> 
                Criar Tarefa Pontual
            </button>
        </div>
    </div>

    <div class="tasks">
        <div class="task-card" *ngFor="let task of dailyTasks">
            <div class="task-info">
                <div class="responsible">
                    <input type="checkbox" class="check-response">
                    <span class="fas fa-trash"></span>
                </div>
                <h2>{{ task.title }}</h2>
                <p>{{ task.description || 'Sem descrição' }}</p>
                <small class="task-member">Responsável: {{ task.member_name }}</small>
            </div>

            <div class="task-atribute">
                <span class="task-priority" [ngClass]="'priority-' + task.priority.toLowerCase()">
                    Prioridade {{ task.priority.toLowerCase() }}
                </span>
                <span class="task-status" [ngClass]="'status-' + task.status.toLowerCase()">
                    {{ task.status }}
                </span>
            </div>
        </div>

        <!-- Mensagem quando não há tarefas -->
        <div class="no-tasks" *ngIf="dailyTasks.length === 0">
            <i class="fas fa-tasks"></i>
            <p>Nenhuma tarefa diária criada ainda.</p>
            <p>Clique em "Criar Tarefa" para começar!</p>
        </div>
    </div>
</div>

<!-- Modal para criar tarefa diária -->
<div class="modal-overlay" *ngIf="showCreateTaskModal" (click)="closeCreateTaskModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
        <div class="modal-header">
            <h2>
                <i class="fas fa-plus-circle"></i>
                Criar Nova Tarefa Diária
            </h2>
            <button class="close-btn" (click)="closeCreateTaskModal()">
                <i class="fas fa-times"></i>
            </button>
        </div>

        <form [formGroup]="taskForm" (ngSubmit)="onSubmitTask()" class="task-form">
            <div class="form-row">
                <div class="form-group">
                    <label for="name">Nome da Tarefa</label>
                    <input 
                        type="text" 
                        id="name" 
                        formControlName="name"
                        placeholder="Ex: Lavar a louça"
                        [class.error]="taskForm.get('name')?.invalid && taskForm.get('name')?.touched"
                    >
                    <div class="error-message" *ngIf="taskForm.get('name')?.invalid && taskForm.get('name')?.touched">
                        <span *ngIf="taskForm.get('name')?.errors?.['required']">Nome é obrigatório</span>
                        <span *ngIf="taskForm.get('name')?.errors?.['minlength']">Nome deve ter pelo menos 3 caracteres</span>
                    </div>
                </div>

                <div class="form-group">
                    <label for="member">Pessoa Responsável</label>
                    <select 
                        id="member" 
                        formControlName="member"
                    >
                        <option value="">Selecione um membro</option>
                        <option *ngFor="let member of familyMembers" [value]="member.id">
                            {{ member.name }} ({{ member.role === 'ADMIN' ? 'Admin' : 'Membro' }})
                        </option>
                    </select>
                </div>
            </div>

            <div class="form-group">
                <label for="description">Descrição</label>
                <textarea 
                    id="description" 
                    formControlName="description"
                    placeholder="Descreva detalhadamente a tarefa..."
                    rows="3"
                ></textarea>
            </div>

            <div class="form-group">
                <label for="priority">Nível de Prioridade</label>
                <select id="priority" formControlName="priority">
                    <option value="BAIXA">Baixa</option>
                    <option value="MEDIA">Média</option>
                    <option value="ALTA">Alta</option>
                </select>
            </div>

            <div class="form-info-note">
                <div class="info-card">
                    <i class="fas fa-info-circle"></i>
                    <div class="info-text">
                        <strong>Status Automático</strong>
                    </div>
                </div>
            </div>

            <div class="form-actions">
                <button type="button" class="btn-cancel" (click)="closeCreateTaskModal()">
                    Cancelar
                </button>
                <button type="submit" class="btn-submit" [disabled]="isLoading">
                    <i class="fas fa-spinner fa-spin" *ngIf="isLoading"></i>
                    <i class="fas fa-check" *ngIf="!isLoading"></i>
                    {{ isLoading ? 'Criando...' : 'Criar Tarefa' }}
                </button>
            </div>
        </form>
    </div>
</div>